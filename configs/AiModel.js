const {
    GoogleGenerativeAI,
    HarmCategory,
    HarmBlockThreshold,
  } = require("@google/generative-ai");
  
  const apiKey = process.env.EXPO_PUBLIC_GOOGLE_GEMINI_API_KEY;
  const genAI = new GoogleGenerativeAI(apiKey);
  
  const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash",
  });
  
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 40,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
  };
  

    export const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "Generate a detailed travel itinerary for Egypt for 5 days and 4 nights for Family within a Luxury budget. The response must be in JSON format only, containing: {\"FlightDetails\": {\"options\": [], \"prices\": [], \"bookingURLs\": []}, \"Hotels\": [{\"name\": \"\", \"address\": \"\", \"price\": \"\", \"imageURL\": \"\", \"geoCoordinates\": \"\", \"rating\": \"\", \"description\": \"\"}], \"PlacesToVisit\": [{\"name\": \"\", \"details\": \"\", \"imageURL\": \"\", \"geoCoordinates\": \"\", \"ticketPricing\": \"\", \"travelTime\": \"\"}], \"Itinerary\": [{\"day\": 1, \"places\": [{\"name\": \"\", \"bestTimeToVisit\": \"\"}]}], \"TravelSummary\": {\"destination\": \"{location}\", \"travelDates\": \"From {startDate} to {endDate}\", \"totalDays\": 5, \"totalNights\": 4}}. Response Rules: The response should be in valid JSON format. Do not include any extra text, explanations, or placeholders. Ensure all required details are included in the JSON output every time. Tailor the recommendations based on the location, including top attractions, cultural spots, and must-visit places."},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "```json\n{\n  \"FlightDetails\": {\n    \"options\": [\n      \"Emirates (via Dubai)\",\n      \"EgyptAir (Direct)\",\n      \"Qatar Airways (via Doha)\"\n    ],\n    \"prices\": [\n      \"USD 1800 - 3000 (Return, per person)\",\n      \"USD 1500 - 2500 (Return, per person)\",\n      \"USD 1900 - 3200 (Return, per person)\"\n    ],\n    \"bookingURLs\": [\n      \"www.emirates.com\",\n      \"www.egyptair.com\",\n      \"www.qatarairways.com\"\n    ]\n  },\n  \"Hotels\": [\n    {\n      \"name\": \"Four Seasons Hotel Cairo at Nile Plaza\",\n      \"address\": \"1089 Corniche El Nil, Garden City, Cairo, Egypt\",\n      \"price\": \"USD 500 - 800 per night\",\n      \"imageURL\": \"https://example.com/fourseasons_cairo.jpg\",\n      \"geoCoordinates\": \"30.0435° N, 31.2357° E\",\n      \"rating\": \"5 stars\",\n      \"description\": \"Luxury hotel overlooking the Nile, offering exceptional service and amenities.\"\n    },\n    {\n      \"name\": \"The Nile Ritz-Carlton, Cairo\",\n      \"address\": \"1113 Corniche El Nil, Cairo, Egypt\",\n      \"price\": \"USD 450 - 750 per night\",\n      \"imageURL\": \"https://example.com/ritzcarlton_cairo.jpg\",\n      \"geoCoordinates\": \"30.0456° N, 31.2339° E\",\n      \"rating\": \"5 stars\",\n      \"description\": \"Iconic hotel with stunning Nile views and world-class dining options.\"\n    },\n    {\n      \"name\": \"Kempinski Nile Hotel Cairo\",\n      \"address\": \"12 Ahmed Ragheb Street, Garden City, Cairo, Egypt\",\n      \"price\": \"USD 400 - 700 per night\",\n      \"imageURL\": \"https://example.com/kempinski_cairo.jpg\",\n      \"geoCoordinates\": \"30.0422° N, 31.2368° E\",\n      \"rating\": \"5 stars\",\n      \"description\": \"Elegant hotel with luxurious rooms, a rooftop pool, and excellent dining.\"\n    }\n  ],\n  \"PlacesToVisit\": [\n    {\n      \"name\": \"Giza Pyramids and Sphinx\",\n      \"details\": \"Ancient pyramids and the Sphinx, one of the Seven Wonders of the Ancient World.\",\n      \"imageURL\": \"https://example.com/giza_pyramids.jpg\",\n      \"geoCoordinates\": \"29.9792° N, 31.1342° E\",\n      \"ticketPricing\": \"USD 20 per person (pyramid entry extra)\",\n      \"travelTime\": \"45 mins from Cairo city center\"\n    },\n    {\n      \"name\": \"Egyptian Museum\",\n      \"details\": \"Home to the world's largest collection of Pharaonic antiquities, including Tutankhamun's treasures.\",\n      \"imageURL\": \"https://example.com/egyptian_museum.jpg\",\n      \"geoCoordinates\": \"30.0477° N, 31.2336° E\",\n      \"ticketPricing\": \"USD 15 per person\",\n      \"travelTime\": \"20 mins from Cairo city center\"\n    },\n    {\n      \"name\": \"Khan el-Khalili Bazaar\",\n      \"details\": \"A famous souk (market) in the historic center of Cairo, offering a wide variety of goods.\",\n      \"imageURL\": \"https://example.com/khan_elkhalili.jpg\",\n      \"geoCoordinates\": \"30.0488° N, 31.2625° E\",\n      \"ticketPricing\": \"Free entry (negotiate prices for purchases)\",\n      \"travelTime\": \"30 mins from Cairo city center\"\n    },\n        {\n      \"name\": \"Luxor Temples (Karnak & Luxor)\",\n      \"details\": \"Magnificent temple complexes showcasing ancient Egyptian architecture and history.\",\n      \"imageURL\": \"https://example.com/luxor_temples.jpg\",\n      \"geoCoordinates\": \"25.7181° N, 32.6531° E\",\n      \"ticketPricing\": \"USD 20-25 per temple per person\",\n      \"travelTime\": \"Flights available or overnight sleeper train from Cairo. Travel time to Luxor is approximately 1 hour by plane and 9-12 hours by train.\"\n    },\n    {\n      \"name\": \"Valley of the Kings\",\n      \"details\": \"The final resting place of pharaohs, including Tutankhamun.\",\n      \"imageURL\": \"https://example.com/valley_of_kings.jpg\",\n      \"geoCoordinates\": \"25.7402° N, 32.6003° E\",\n      \"ticketPricing\": \"USD 15 per person (entry to 3 tombs)\",\n      \"travelTime\": \"Located in Luxor, accessible by taxi or tour bus.\"\n    },\n    {\n      \"name\": \"Abu Simbel Temples\",\n      \"details\": \"Massive rock cut temples dedicated to Ramses II and his queen Nefertari.\",\n      \"imageURL\": \"https://example.com/abu_simbel.jpg\",\n      \"geoCoordinates\": \"22.3392° N, 31.6258° E\",\n      \"ticketPricing\": \"USD 20 per person\",\n      \"travelTime\": \"Flights or organized tours from Aswan. Approximately 45 minutes by plane.\"\n    }\n  ],\n  \"Itinerary\": [\n    {\n      \"day\": 1,\n      \"places\": [\n        {\n          \"name\": \"Arrival in Cairo & Check-in to Hotel\",\n          \"bestTimeToVisit\": \"Afternoon\"\n        },\n        {\n          \"name\": \"Nile River Dinner Cruise\",\n          \"bestTimeToVisit\": \"Evening\"\n        }\n      ]\n    },\n    {\n      \"day\": 2,\n      \"places\": [\n        {\n          \"name\": \"Giza Pyramids and Sphinx\",\n          \"bestTimeToVisit\": \"Morning (early to avoid crowds)\"\n        },\n        {\n          \"name\": \"Egyptian Museum\",\n          \"bestTimeToVisit\": \"Afternoon\"\n        }\n      ]\n    },\n    {\n      \"day\": 3,\n      \"places\": [\n        {\n          \"name\": \"Fly to Luxor\",\n          \"bestTimeToVisit\": \"Morning\"\n        },\n        {\n          \"name\": \"Karnak Temple\",\n          \"bestTimeToVisit\": \"Afternoon\"\n        },\n        {\n          \"name\": \"Luxor Temple\",\n          \"bestTimeToVisit\": \"Evening (especially illuminated)\"\n        }\n      ]\n    },\n    {\n      \"day\": 4,\n      \"places\": [\n        {\n          \"name\": \"Valley of the Kings\",\n          \"bestTimeToVisit\": \"Morning (early to avoid heat)\"\n        },\n        {\n          \"name\": \"Hatshepsut Temple\",\n          \"bestTimeToVisit\": \"Late Morning\"\n        },\n        {\n          \"name\": \"Fly back to Cairo\",\n          \"bestTimeToVisit\": \"Afternoon\"\n        }\n      ]\n    },\n    {\n      \"day\": 5,\n      \"places\": [\n        {\n          \"name\": \"Khan el-Khalili Bazaar\",\n          \"bestTimeToVisit\": \"Morning\"\n        },\n        {\n          \"name\": \"Departure from Cairo\",\n          \"bestTimeToVisit\": \"Afternoon/Evening\"\n        }\n      ]\n    }\n  ],\n  \"TravelSummary\": {\n    \"destination\": \"Egypt (Cairo & Luxor)\",\n    \"travelDates\": \"From {startDate} to {endDate}\",\n    \"totalDays\": 5,\n    \"totalNights\": 4\n  }\n}\n```"},
          ],
        },
      ],
    });
  
    // const result = await chatSession.sendMessage("INSERT_INPUT_HERE");
    // console.log(result.response.text());
